---
import Container from '@/components/Container.astro';
import { getSiteConfig } from '@/lib/config';

const base = import.meta.env.BASE_URL;
const pathname = Astro.url.pathname.replace(base, '') || '/';

const isHomePage = pathname === '/';
const isWritingPage = pathname.startsWith('/writing');
const isShopPage = pathname.startsWith('/shop');

// Helper to create proper URLs (avoid double slashes)
const createUrl = (path: string) => {
  const cleanBase = base.endsWith('/') ? base.slice(0, -1) : base;
  return path === '/' ? base : `${cleanBase}${path}`;
};

const config = getSiteConfig();
---
{config.elements.header && (
  <Container
    as="header"
    class="w-full max-w-full flex justify-center items-center"
  >
    <div
      class="w-max fixed top-0 mt-5 bg-muted-foreground/40 backdrop-blur-3xl border border-border rounded-full p-1"
    >
      <nav class="flex items-center">
        <ul class="flex items-center gap-1">
          <li>
            <a
              href={createUrl('/')}
              class:list={[
                'font-medium transition-colors block px-5 py-2',
                'hover:text-headings',
                isHomePage && 'text-headings bg-muted-foreground/40 rounded-full',
              ]}>Home</a
            >
          </li>
          {config.sections.writing && (
            <li>
              <a
                href={createUrl('/writing')}
                class:list={[
                  'font-medium transition-colors block px-5 py-2',
                  'hover:text-headings',
                  isWritingPage &&
                    'text-headings bg-muted-foreground/40 rounded-full',
                ]}>Writing</a
              >
            </li>
          )}
          {config.sections.shop && (
            <li>
              <a
                href={createUrl('/shop')}
                class:list={[
                  'font-medium transition-colors block px-5 py-2',
                  'hover:text-headings',
                  isShopPage &&
                    'text-headings bg-muted-foreground/40 rounded-full',
                ]}>Shop</a
              >
            </li>
          )}
        </ul>
      </nav>
    </div>
  </Container>
)}